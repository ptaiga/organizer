{% extends "organizer/index.html" %}

{% block nav-center %}
<a href="{% url 'organizer:project' task.project.id|default:'0' %}" class="back">&lt;&lt;</a>
{% endblock %}

{% block article %}

    <h2>{{ task }}</h2>

    <form action="{% url 'organizer:tasks_change' task.id %}" method="post">
        {% csrf_token %}
        <ul>
            <li>Owner: {{ user }}</li>
            <li>Date published: {{ task.pub_date }}</li>
            <li>Task: <input type="text" name="task_name" value="{{ task.task_name }}"></li>
            <li>Project:
                <select name="project_select">
                    <option value="0">Inbox</option>
                    {% for project in project_list%}
                    <option value="{{ project.id }}"{% if task.project == project %} selected {% endif %}>{{ project }}</option>
                    {% endfor %}
                </select>
            </li>
            <li>Status:
                <select name="done_flag">
                    <option value="False">Active</option>
                    <option value="True"{% if task.done_flag %} selected {% endif %}>Closed</option>
                </select>
            </li>
            <li>Deadline:
                <input type="date" name="due_date_d" value="{{ task.due_date.date|date:"Y-m-d" }}">
                <input type="time" name="due_date_t" value="{{ task.due_date.time|time:"H:i" }}">
            </li>
        </ul>
        <input type="submit" value="Save changes">
    </form>

    <hr>

    <h3>Comments:</h3>

    {% if comment_list %}
        <ul>
        {% for comment in comment_list %}
            <li>
                <p><u>{{ comment.pub_date }}</u>:</p>
                <p>{{ comment.comment_text }}</p>
                <form action="{% url 'organizer:comments_del' task.id %}" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="comment_id" value="{{ comment.id }}">
                    <input type="submit" value="Delete">
                </form>
            </li>
        {% endfor %}
        </ul>
    {% endif %}

    <form action="{% url 'organizer:comments_add' task.id %}" method="post">
        {% csrf_token %}
        <textarea name="comment_text" rows="5" cols="50"></textarea>
        <input type="submit" value="Add">
    </form>

{% endblock %}
